#include <iostream>
#include <ctime>
#include <cstdlib>
#include <cfloat>
#include <cmath>
#include "obj_detector.h"
#include <stdio.h>
#include <fstream>

using namespace std;

#define EPSILON (1e-4)  // do not chanage this value

void obj_detector_sw(float A[N][N], float W0[NUM_NEURONS][M][M], float W1[NUM_CLASSES][NUM_NEURONS*((N-M+1)/2)*((N-M+1)/2)], float res[NUM_CLASSES]);
void convolve_sw(float A[N][N], float B[M][M], float conv[N-M+1][N-M+1]);
void ReLU_sw(float inp[N-M+1][N-M+1], float out[N-M+1][N-M+1]);
void maxpool_sw(float inp[N-M+1][N-M+1], float out[(N-M+1)/2][(N-M+1)/2]);
void flatten_sw(float inp[NUM_NEURONS][(N-M+1)/2][(N-M+1)/2], float out[NUM_NEURONS*((N-M+1)/2)*((N-M+1)/2)]);
float FCL_sw(float inp[NUM_NEURONS*((N-M+1)/2)*((N-M+1)/2)], float W[NUM_NEURONS*((N-M+1)/2)*((N-M+1)/2)]);
void softmax_sw(float inp[NUM_CLASSES], float out[NUM_CLASSES]);

bool nearlyEqual(float a, float b) {
  // The Floating Point Guide, http://floating-point-gui.de/errors/comparison/
  float absA = fabs(a);
  float absB = fabs(b);
  float diff = fabs(a - b);

  if (a == b) { // shortcut, handles infinities
    return true;
  } else if (a == 0 || b == 0 || diff < FLT_MIN) {
    // a or b is zero or both are extremely close to it
    // relative error is less meaningful here
    return diff < (EPSILON * FLT_MIN);
  } else { // use relative error
    return diff / min((absA + absB), FLT_MAX) < EPSILON;
  }
}

int main(int argc, char **argv)
{
  // doubled bufffered
  mat_a in_mat_a[N][N];
//  mat_b in_mat_w0[NUM_NEURONS][M][M];
//  mat_b in_mat_w1[NUM_CLASSES][NUM_NEURONS*((N-M+1)/2)*((N-M+1)/2)];
  //mat_b res[NUM_CLASSES];
  mat_conv hw_result[NUM_CLASSES], sw_result[NUM_CLASSES];

  ifstream image0;
  ifstream image1;
  clock_t start, end;

  image0.open("images0.bin", ios::binary | ios::in);
  image1.open("images1.bin", ios::binary | ios::in);

  float in_mat_w0[NUM_NEURONS][M][M] = {
  		{
  			{-0.11172096,  0.11983648, -0.0540421,   0.03428871,  0.11637007},
  			{ 0.04995781,  0.00043249, -0.19380781, -0.1220828,  -0.03462377},
  			{ 0.07867375,  0.09386019, -0.08044927, -0.18486413, -0.0977354 },
  			{ 0.14506553, -0.13540909, -0.04525939,  0.13307793, -0.19924547},
  			{ 0.02011814,  0.13836825, -0.12075682,  0.00081436,  0.1472384 }
  		},

  		{
  			{-0.10123073,  0.03904423,  0.08167487,  0.03948735, -0.0231303},
  			{-0.08781666,  0.01501991, -0.05410987, -0.02487675, -0.05003701},
  			{ 0.13517417,  0.10804742, -0.06809852,  0.02214178, -0.08173507},
  			{-0.00324729, -0.03448447,  0.070024,   -0.05810821, -0.00999617},
  			{ 0.09757017, -0.00746511,  0.17042696, -0.11856362,  0.10661397}
  		},

  		{
  			{-0.02380879, -0.04043684,  0.0363274,   0.00369531, -0.00942815},
  			{-0.1946338,  -0.1743848,   0.05761796,  0.0053152,   0.10116666},
  			{ 0.15013015,  0.04054071, -0.18968257, -0.06067897,  0.06062724},
  			{-0.12530424,  0.14652383,  0.14519468,  0.14492276,  0.01226158},
  			{ 0.10107711, -0.15782781, -0.07719218,  0.01509317,  0.11082919}
  		},

  		{
  			{ 0.0277561,  -0.10761357, -0.06672421, -0.09181187, -0.09809311},
  		    {-0.07927755, -0.0068556,  -0.03192107,  0.07750747,  0.08867281},
  		    { 0.0502992,  -0.00991875,  0.08167448,  0.11413333,  0.0482402 },
  		    { 0.14334589,  0.16693553, -0.19288027,  0.11011115, -0.098056  },
  		    { 0.01366047,  0.11669581,  0.06478623, -0.15610252,  0.04366918}
  		},

  		{
  			{-0.14205171,  -0.04388051,  0.10555078, -0.04577396,  0.00539833},
  			{  0.10277621,  0.12964122,  0.07922864, -0.19923885, -0.05203218},
  			{ -0.00250586, -0.1583498,   0.0009344,   0.0172613,   0.0934758 },
  			{  0.16020975, -0.14262056, -0.11263071,  0.03001748, -0.1632107 },
  			{ -0.117385,    0.00636674, -0.14709868,  0.07302225,  0.10567357}
  		},

  		{
  			{-0.19448732, -0.00392736,  0.09098662,  0.15872894, -0.09614713},
  			{-0.14478338,  0.12247242,  0.14540681, -0.10793481, -0.00832517},
  			{ 0.0494865,   0.10616458, -0.11839417,  0.07758239,  0.14044829},
  			{-0.0093183,  -0.13789026, -0.14820303, -0.07759,     0.13547613},
  			{-0.18097082, -0.17436746, -0.03637646, -0.17209803, -0.12416901}
  		  }
  };

  float in_mat_w1[NUM_CLASSES][NUM_NEURONS*((N-M+1)/2)*((N-M+1)/2)] = {
  		{
  				 4.12005186e-03,
  				 2.67051830e-04,
  				 1.63377495e-04,
  				 1.06521398e-01,
  				-2.34139506e-02,
  				 5.24759665e-02,
  				-7.75898900e-03,
  				 5.71653321e-02,
  				 6.45713210e-02,
  				-3.64785008e-02,
  				-6.55657947e-02,
  				-7.18342364e-02,
  				-5.90078197e-02,
  				 1.06136631e-02,
  				 2.56928653e-02,
  				-1.79475863e-02,
  				-4.65150289e-02,
  				-2.76662260e-02,
  				-4.21898775e-02,
  				 5.34764007e-02,
  				-3.13692316e-02,
  				-1.89928915e-02,
  				-9.63884592e-03,
  				-2.62202155e-02,
  				 4.06052172e-02,
  				-6.70832023e-02,
  				 8.19117203e-02,
  				-3.98277678e-02,
  				 3.64409089e-02,
  				-6.19018264e-02,
  				 8.38633254e-02,
  				 2.25595739e-02,
  				 7.82651156e-02,
  				 1.83444167e-03,
  				-7.94987902e-02,
  				-5.42952344e-02,
  				-5.07020056e-02,
  				-1.50057524e-02,
  				-7.09761307e-02,
  				 4.22142632e-02,
  				-5.17857969e-02,
  				-6.75376728e-02,
  				 2.37046685e-02,
  				 7.91694131e-03,
  				-4.97212186e-02,
  				-2.44191661e-02,
  				 3.94997858e-02,
  				 7.20681041e-04,
  				 3.45021002e-02,
  				-2.34918837e-02,
  				-8.91823769e-02,
  				-3.78909148e-02,
  				 3.15543152e-02,
  				 7.27190748e-02,
  				-9.85035859e-03,
  				-6.70782775e-02,
  				 1.93065759e-02,
  				-3.22372466e-02,
  				-4.39997576e-02,
  				 6.87467959e-03,
  				-9.19235274e-02,
  				 5.64375520e-02,
  				-7.83226267e-02,
  				 3.89081389e-02,
  				 4.37869914e-02,
  				 1.06025614e-01,
  				-5.50880730e-02,
  				-4.00195308e-02,
  				-1.02534220e-02,
  				-8.10477361e-02,
  				-7.27418438e-02,
  				-8.87620673e-02,
  				-9.08250511e-02,
  				-8.97340477e-02,
  				 1.52167706e-02,
  				-4.18503545e-02,
  				 9.42304730e-02,
  				 1.65420305e-02,
  				 6.14712723e-02,
  				-3.77823482e-03,
  				 4.77898791e-02,
  				 4.69680615e-02,
  				-8.66397619e-02,
  				-2.04596445e-02,
  				 2.98672672e-02,
  				-2.39049550e-03,
  				 8.60750768e-03,
  				-3.16650160e-02,
  				-2.52698660e-02,
  				-7.31569889e-04,
  				-7.36690406e-03,
  				 3.76724005e-02,
  				 4.47822437e-02,
  				 1.95873268e-02,
  				-2.35210694e-02,
  				-5.32073015e-03,
  				 1.81385465e-02,
  				 2.99467761e-02,
  				-8.32041502e-02,
  				-4.33812104e-02,
  				-5.82610145e-02,
  				 5.90168312e-02,
  				-7.48519003e-02,
  				-5.12245931e-02,
  				-1.94916856e-02,
  				 3.98005508e-02,
  				 4.81292121e-02,
  				-5.16989380e-02,
  				-7.19103143e-02,
  				-3.31677906e-02,
  				-1.84880979e-02,
  				-8.48453417e-02,
  				-2.18383595e-02,
  				 7.21263364e-02,
  				 1.52570428e-02,
  				-4.89338785e-02,
  				 5.91567829e-02,
  				 3.19042020e-02,
  				-1.28192483e-02,
  				 7.84761179e-03,
  				 3.96757945e-02,
  				 3.59691679e-02,
  				 6.61563873e-02,
  				-4.81724367e-02,
  				 6.55737668e-02,
  				 6.37626450e-04,
  				-1.78703677e-03,
  				-5.21447323e-02,
  				 6.30074516e-02,
  				-3.36985178e-02,
  				 5.56374416e-02,
  				 8.40794221e-02,
  				-3.29519995e-02,
  				 2.25154087e-02,
  				-6.17113747e-02,
  				 6.57289922e-02,
  				 6.77658767e-02,
  				 7.12345764e-02,
  				 6.41095638e-02,
  				-3.60238515e-02,
  				 7.27852955e-02,
  				-1.85700487e-02,
  				 8.46198127e-02,
  				-5.39728925e-02,
  				-3.36395316e-02,
  				 1.05959503e-02,
  				 1.84480492e-02,
  				 8.08813870e-02,
  				-3.67261693e-02,
  				 2.04131864e-02,
  				-4.40168679e-02,
  				-4.25081700e-02,
  				 4.16754372e-02,
  				 3.50205675e-02,
  				 1.25597902e-02,
  				 8.74214992e-03,
  				 4.73869890e-02,
  				-4.31212038e-02,
  				 1.89704783e-02,
  				 7.67894974e-03,
  				-3.34123932e-02,
  				 4.91138436e-02,
  				-5.84183559e-02,
  				-6.30825162e-02,
  				-5.18513545e-02,
  				 7.10307583e-02,
  				-3.64485942e-02,
  				 2.14714766e-03,
  				 1.36128161e-03,
  				 3.22796069e-02,
  				 2.61297505e-02,
  				-5.25382087e-02,
  				 9.05708149e-02,
  				 1.76963978e-03,
  				-2.41097957e-02,
  				 1.85997747e-02,
  				 8.85420293e-02,
  				 6.67663589e-02,
  				-2.14258991e-02,
  				-5.66789368e-03,
  				 8.26392323e-03,
  				 9.24121290e-02,
  				 2.81808563e-02,
  				 5.84546588e-02,
  				-6.43858686e-02,
  				-5.13502695e-02,
  				 8.36062729e-02,
  				 2.98642479e-02,
  				 3.28996889e-02,
  				-1.05802715e-03,
  				-4.85543273e-02,
  				 7.08068907e-03,
  				-5.68654053e-02,
  				 3.42287160e-02,
  				 5.82623743e-02,
  				 2.85332836e-02,
  				-8.94364268e-02,
  				 5.11470214e-02,
  				-4.61172238e-02,
  				-7.34456182e-02,
  				-8.84230286e-02,
  				-2.15732083e-02,
  				-1.89827550e-02,
  				-1.70914941e-02,
  				-9.18791443e-02,
  				-1.04029356e-02,
  				-3.19853872e-02,
  				 1.10857021e-02,
  				-8.57395306e-02,
  				-3.10589634e-02,
  				-3.72052565e-02,
  				-6.97790459e-02,
  				-3.99476327e-02,
  				 1.19254207e-02,
  				 4.63788770e-02,
  				 4.82043549e-02,
  				-4.72701900e-02,
  				-4.60156705e-03,
  				 3.75415571e-02,
  				 2.32417192e-02,
  				-1.37140397e-02,
  				 2.16688332e-03,
  				 8.75063837e-02,
  				-1.26850203e-01,
  				-1.83238965e-02,
  				-6.99985176e-02,
  				-2.39894558e-02,
  				-5.56679294e-02,
  				-2.23457497e-02,
  				-6.66706264e-02,
  				-5.60118491e-03,
  				-4.15309630e-02,
  				 7.39120394e-02,
  				 8.28078240e-02,
  				 2.82890443e-02,
  				 5.03133200e-02,
  				-8.45248103e-02,
  				-6.53993487e-02,
  				-8.89002979e-02,
  				 3.98984812e-02,
  				 2.67696241e-03,
  				 1.78016517e-02,
  				-4.62423190e-02,
  				-6.08516932e-02,
  				-5.50822206e-02,
  				-5.69770001e-02,
  				 5.62182032e-02,
  				-4.75273058e-02,
  				 2.45139711e-02,
  				-6.34254590e-02,
  				 5.46176918e-02,
  				 7.22913593e-02,
  				-6.71603680e-02,
  				-8.01934823e-02,
  				-2.59576086e-03,
  				 6.69100732e-02,
  				-4.08573821e-02,
  				-6.23358563e-02,
  				-4.48034406e-02,
  				 5.29590435e-02,
  				-7.93719962e-02,
  				-1.92158669e-02,
  				-1.56044494e-02,
  				 3.62462625e-02,
  				-1.58053245e-02,
  				-5.35549410e-02,
  				-1.62851792e-02,
  				 4.91930880e-02,
  				-4.63481098e-02,
  				 2.85932608e-02,
  				 5.53711057e-02,
  				 7.31332824e-02,
  				 9.32811573e-02,
  				 7.31825903e-02,
  				-1.89365633e-02,
  				 8.72373655e-02,
  				 3.05220392e-02,
  				 7.89865851e-02,
  				-4.70419414e-02,
  				-7.60793462e-02,
  				 8.89065862e-03,
  				 7.65267983e-02,
  				-3.03972382e-02,
  				-5.99590354e-02,
  				 8.36722329e-02,
  				 5.27279489e-02,
  				 2.54941620e-02,
  				-3.35088819e-02,
  				-1.96329178e-03,
  				-5.56137376e-02,
  				 8.26015919e-02,
  				 6.83399439e-02,
  				 1.76525023e-02,
  				 3.55811641e-02,
  				 6.08189628e-02,
  				 7.04244301e-02,
  				-6.34207204e-03,
  				 1.28948847e-02,
  				-6.72601014e-02,
  				 1.96507499e-02,
  				 4.18710150e-03,
  				-1.14914337e-02,
  				 4.51684706e-02,
  				-6.86864406e-02,
  				 6.79190606e-02,
  				-1.03851147e-02,
  				 4.64687645e-02,
  				 9.79426596e-03,
  				-9.76155419e-03,
  				-3.24621089e-02,
  				 5.40716574e-02,
  				 3.17876264e-02,
  				 3.21445917e-03,
  				 1.56013127e-02,
  				 5.12195379e-02,
  				 2.92716753e-02,
  				-6.02306053e-03,
  				 8.49254616e-03,
  				-1.77374426e-02,
  				-4.75329980e-02,
  				 7.95260072e-02,
  				-7.13467821e-02,
  				 5.63099459e-02,
  				 7.88005814e-02,
  				 6.39463170e-03,
  				-5.36756217e-02,
  				 3.49900611e-02,
  				-9.26295072e-02,
  				 3.11385300e-02,
  				-7.52234906e-02,
  				 3.82305607e-02,
  				-1.86570473e-02,
  				-6.76747784e-02,
  				 5.69270663e-02,
  				 3.39489989e-02,
  				 4.35021892e-02,
  				 4.53887731e-02,
  				-3.47702135e-03,
  				-1.65885575e-02,
  				 5.72443567e-03,
  				-5.25776818e-02,
  				-1.96589134e-03,
  				-3.96543704e-02,
  				 9.61887687e-02,
  				 8.44757557e-02,
  				-1.05785867e-02,
  				-1.00109033e-01,
  				 2.48747971e-02,
  				-8.54886398e-02,
  				-3.44704427e-02,
  				 3.34554836e-02,
  				-1.15004880e-02,
  				-5.49709909e-02,
  				 2.26207003e-02,
  				 2.66234297e-03,
  				 1.09931238e-01,
  				-4.35596285e-03,
  				-8.71642455e-02,
  				 4.39127907e-02,
  				-2.70350762e-02,
  				-9.26296879e-03,
  				 6.92817150e-04,
  				-5.92395738e-02,
  				 3.15282047e-02,
  				-2.84837876e-02,
  				-7.43442923e-02,
  				 2.24128645e-02,
  				 8.42354894e-02,
  				-5.65712601e-02,
  				-1.29528511e-02,
  				-3.77408415e-02,
  				-1.33238835e-02,
  				 2.65318938e-02,
  				-5.31302989e-02,
  				-1.33877145e-02,
  				-1.04127161e-01,
  				 3.83798517e-02,
  				-5.71291940e-03,
  				 3.78220864e-02,
  				-5.86146535e-03,
  				-9.58080776e-03,
  				 2.46579573e-03,
  				-4.41252291e-02,
  				-2.73744576e-02,
  				 4.99726757e-02,
  				-4.99177985e-02,
  				-5.96571043e-02,
  				 1.40794748e-02,
  				-2.22481899e-02,
  				 5.41629051e-05,
  				 1.09903095e-02,
  				 5.13385870e-02,
  				-9.52712372e-02,
  				 1.90908182e-02,
  				-7.50374272e-02,
  				 5.94647340e-02,
  				-9.95330978e-03,
  				 2.65672617e-02,
  				-3.44833769e-02,
  				 5.54378796e-03,
  				-3.71316425e-03,
  				 5.56668788e-02,
  				 3.36947329e-02,
  				-2.09920071e-02,
  				-6.20953366e-02,
  				 5.52591644e-02,
  				-2.21841950e-02,
  				-3.60083655e-02,
  				-1.21361054e-02,
  				-4.01307456e-02,
  				 6.89546615e-02,
  				-4.39957716e-02,
  				-7.19049573e-02,
  				 3.92115936e-02,
  				 4.31043357e-02,
  				-3.42881717e-02,
  				 8.34736675e-02,
  				 5.96885830e-02,
  				-6.69068918e-02,
  				-1.19258529e-02,
  				 9.72705781e-02,
  				-6.13121726e-02,
  				-7.02586994e-02,
  				 1.84297934e-02,
  				-8.87781233e-02,
  				-4.97092586e-03,
  				 4.01771255e-02,
  				-3.36999595e-02,
  				-3.45469872e-03,
  				-2.49859001e-02,
  				-3.47666591e-02,
  				 1.28397252e-02,
  				 5.57357036e-02,
  				-5.28833009e-02,
  				-5.77490265e-03,
  				 8.50865096e-02,
  				 2.69548874e-02,
  				 2.04070788e-02,
  				-4.92304377e-02,
  				 9.35888141e-02,
  				 8.93773802e-04,
  				-3.97412032e-02,
  				-4.85452861e-02,
  				-5.08745685e-02,
  				 4.96099852e-02,
  				 4.94191051e-02,
  				 1.07927315e-01,
  				 2.22599320e-02,
  				 1.14712827e-02,
  				-4.24677320e-02,
  				-3.08043025e-02,
  				 7.94659108e-02,
  				-1.23759937e-02,
  				-6.71970025e-02,
  				 2.18767747e-02,
  				-6.51670247e-02,
  				 4.58845645e-02,
  				 2.92586945e-02,
  				 8.76329765e-02,
  				 4.97113466e-02,
  				 6.35375977e-02,
  				-1.37651414e-02,
  				-2.54405721e-04,
  				 1.01505220e-02,
  				-6.59945384e-02,
  				 4.33260240e-02,
  				 7.43496642e-02,
  				-3.33277322e-02,
  				 1.56908724e-02,
  				 4.99730296e-02,
  				-4.02357131e-02,
  				 8.83525237e-03,
  				-3.91662382e-02,
  				 6.04115389e-02,
  				-3.67619433e-02,
  				-8.04764703e-02,
  				 2.10298714e-03,
  				-8.26480463e-02,
  				-8.05343390e-02,
  				-5.54284677e-02,
  				-5.54369166e-02,
  				-5.11968434e-02,
  				-1.16616776e-02,
  				 1.63180921e-02,
  				-2.93821190e-02,
  				 8.84179678e-03,
  				 5.64034767e-02,
  				 2.59834677e-02,
  				-3.98414545e-02,
  				 4.21864726e-02,
  				-6.15302175e-02,
  				-5.43877333e-02,
  				-5.71549423e-02,
  				-3.05295531e-02,
  				 2.20589917e-02,
  				-1.78196449e-02,
  				 4.39654440e-02,
  				-6.12138920e-02,
  				-6.48865551e-02,
  				 5.92873432e-02,
  				 5.68772405e-02,
  				-7.23687932e-02,
  				 6.29472604e-04,
  				 5.74629419e-02,
  				-2.48382296e-02,
  				-1.01978257e-01,
  				-7.91502073e-02,
  				 2.39775963e-02,
  				-8.96986052e-02,
  				 2.21828334e-02,
  				 7.17528984e-02,
  				-3.98317166e-02,
  				-8.83588046e-02,
  				 4.28383239e-02,
  				 3.47978510e-02,
  				-2.99129747e-02,
  				 3.26973945e-02,
  				-5.64137148e-03,
  				-6.73774779e-02,
  				 2.72018109e-02,
  				 7.26583749e-02,
  				 7.28857890e-02,
  				-6.21628016e-02,
  				 1.40665695e-02,
  				 9.41554084e-03,
  				 2.09457204e-02,
  				 5.22823520e-02,
  				-5.34740798e-02,
  				-4.52704877e-02,
  				 7.23386649e-03,
  				-6.46322444e-02,
  				-1.24592567e-02,
  				 5.53451814e-02,
  				 7.40646198e-02,
  				 6.44001737e-02,
  				 1.11238705e-02,
  				 4.22284566e-02,
  				 5.11196349e-03,
  				 3.12378276e-02,
  				-3.77662741e-02,
  				 3.19427885e-02,
  				-1.92599613e-02,
  				 3.71973440e-02,
  				-6.25138506e-02,
  				-6.16651811e-02,
  				-6.38277754e-02,
  				 2.84651592e-02,
  				 5.41452058e-02,
  				-6.24627694e-02,
  				-4.82997997e-03,
  				 7.21631125e-02,
  				 2.98238415e-02,
  				 2.78172083e-02,
  				-2.53504142e-02,
  				 2.08665803e-02,
  				-7.40172714e-02,
  				 7.95771629e-02,
  				 4.69629765e-02,
  				-7.95710534e-02,
  				 4.16492671e-02,
  				-5.33803366e-02,
  				 3.38113606e-02,
  				 7.09341690e-02,
  				-7.27167055e-02,
  				-4.49620709e-02,
  				 3.67459394e-02,
  				-3.43301892e-02,
  				-8.66872892e-02,
  				-8.48768055e-02,
  				 1.40189733e-02,
  				 7.71473274e-02,
  				-6.97192103e-02,
  				 1.09861940e-02,
  				-2.90145464e-02,
  				 2.98447330e-02,
  				 4.74323966e-02,
  				-3.07610277e-02,
  				 7.07263798e-02,
  				 8.91527832e-02,
  				 7.17231929e-02,
  				 1.75433252e-02,
  				-5.52864857e-02,
  				 2.75487620e-02,
  				 2.34773774e-02,
  				 6.37295842e-02,
  				 1.78691149e-02,
  				 3.28620486e-02,
  				 4.91642840e-02,
  				-5.93968816e-02,
  				 1.19248377e-02,
  				-8.15828219e-02,
  				-8.29463229e-02,
  				-4.82498072e-02,
  				-1.65599789e-02,
  				-3.96265350e-02,
  				-3.84329818e-02,
  				-2.73426604e-02,
  				-4.67488207e-02,
  				-6.96128383e-02,
  				-6.16749823e-02,
  				-3.85664664e-02,
  				 2.33716257e-02,
  				-7.24357879e-03,
  				-6.89182878e-02,
  				-3.62657942e-02,
  				 2.06770673e-02,
  				-4.85939756e-02,
  				 8.67404714e-02,
  				 1.62375811e-02,
  				 5.89857325e-02,
  				 3.57338488e-02,
  				-7.65912756e-02,
  				 7.08436072e-02,
  				-3.27780470e-02,
  				 2.52928678e-02,
  				-3.98612879e-02,
  				-2.76875030e-02,
  				-6.19303100e-02,
  				-7.00995773e-02,
  				-1.61553686e-03,
  				 1.65356277e-03,
  				 6.96977600e-02,
  				 2.74261143e-02,
  				 4.88791335e-03,
  				-7.05366060e-02,
  				-7.82082900e-02,
  				 1.81680005e-02,
  				 4.41702604e-02,
  				-2.61427443e-02,
  				 5.58180325e-02,
  				-3.95307988e-02,
  				 3.20992991e-03,
  				 8.77759159e-02,
  				 3.33007202e-02,
  				 3.60411555e-02,
  				 4.22098897e-02,
  				 3.31841856e-02,
  				 1.66568370e-03,
  				 2.62176115e-02,
  				-4.01715711e-02,
  				 1.83347277e-02,
  				 3.29987556e-02,
  				-2.44753100e-02,
  				-4.99946512e-02,
  				-4.05571498e-02,
  				 4.06711176e-02,
  				-2.04107799e-02,
  				-5.78074381e-02,
  				-9.17792916e-02,
  				-6.75231665e-02,
  				 4.11388054e-02,
  				 4.71292287e-02,
  				 2.97564622e-02,
  				 8.71101171e-02,
  				 5.81474081e-02,
  				-5.47367632e-02,
  				-4.64319997e-02,
  				 4.30789553e-02,
  				 3.98090156e-03,
  				 1.06499894e-02,
  				 8.86113755e-03,
  				-8.89359340e-02,
  				 4.91866134e-02,
  				 6.60914779e-02,
  				-6.46663979e-02,
  				 6.02827035e-02,
  				-5.96520826e-02,
  				 2.27911044e-02,
  				-2.13703346e-02,
  				-1.02281719e-01,
  				-3.67473029e-02,
  				 6.47008196e-02,
  				-3.43654566e-02,
  				 4.43911366e-02,
  				 2.69535221e-02,
  				 7.23738074e-02,
  				 8.44863243e-03,
  				-2.01845691e-02,
  				-1.94145702e-02,
  				 1.96160655e-02,
  				-1.32474499e-02,
  				 3.12993838e-03,
  				-1.97971128e-02,
  				 1.95520790e-03,
  				-2.27668714e-02,
  				 2.05820091e-02,
  				 3.98367383e-02,
  				 5.68709113e-02,
  				-6.33227602e-02,
  				-5.06335087e-02,
  				-5.76380566e-02,
  				 5.98052666e-02,
  				-9.85796675e-02,
  				 8.44473951e-03,
  				-7.90126026e-02,
  				-8.92258510e-02,
  				 9.28535387e-02,
  				 3.36629823e-02,
  				 3.68998535e-02,
  				-5.66380993e-02,
  				-6.78597465e-02,
  				 1.44667514e-02,
  				 4.63863648e-02,
  				-2.02383492e-02,
  				-8.27715993e-02,
  				 1.97802708e-02,
  				-1.61307007e-02,
  				 8.88582617e-02,
  				 8.24136436e-02,
  				 7.47894868e-02,
  				 7.91978985e-02,
  				 7.68289566e-02,
  				 2.01465525e-02,
  				 1.71308983e-02,
  				 2.23203879e-02,
  				-5.93215302e-02,
  				 5.06983586e-02,
  				 6.82394728e-02,
  				-5.34388721e-02,
  				-7.65910093e-03,
  				-5.70486449e-02,
  				-7.87612721e-02,
  				 1.30567944e-03,
  				 7.84982070e-02,
  				-2.04598880e-03,
  				 2.55551338e-02,
  				 6.21239953e-02,
  				-5.05325422e-02,
  				-4.27892208e-02,
  				 6.93515837e-02,
  				 2.16748398e-02,
  				 3.12318541e-02,
  				-6.77014291e-02,
  				 3.28458659e-02,
  				-3.00468169e-02,
  				-4.88691665e-02,
  				 5.03137102e-03,
  				 7.38917217e-02,
  				-8.25115293e-02,
  				 2.70602386e-02,
  				-5.17468452e-02,
  				 5.88319823e-02,
  				 6.53215349e-02,
  				 5.14712147e-02,
  				 1.88932642e-02,
  				 4.17581648e-02,
  				-3.69688384e-02,
  				-5.22736087e-02,
  				-7.21877813e-02,
  				 6.50015008e-03,
  				-2.58840676e-02,
  				-3.11015695e-02,
  				-2.66403076e-03,
  				 2.10425351e-02,
  				-1.85361896e-02,
  				 7.75599256e-02,
  				-1.56779587e-02,
  				 6.05898015e-02,
  				-7.60531798e-02,
  				 6.00241534e-02,
  				 7.71870986e-02,
  				 5.68921790e-02,
  				 3.56755927e-02,
  				-3.85742895e-02,
  				-5.82737615e-03,
  				-9.98722836e-02,
  				-4.97932024e-02,
  				-6.23763949e-02,
  				-7.23516643e-02,
  				-7.69388452e-02,
  				-2.79054657e-04,
  				-1.61775760e-02,
  				 3.39355618e-02,
  				-5.15957177e-02,
  				-2.61496045e-02,
  				 3.63938548e-02,
  				 2.21642330e-02,
  				-2.92208362e-02,
  				-9.63422507e-02,
  				 5.91856614e-02,
  				-3.15714367e-02,
  				 4.67570499e-02,
  				 2.70401239e-02,
  				 1.15335197e-03,
  				-5.83148049e-03,
  				-1.41415633e-02,
  				 8.02872796e-03,
  				-5.26919886e-02,
  				 2.93432958e-02,
  				-6.38751015e-02,
  				-4.28808741e-02,
  				-4.25717160e-02,
  				-4.42371704e-02,
  				-6.40079938e-03,
  				-8.13498646e-02,
  				-4.90279049e-02,
  				-3.11994459e-02,
  				 8.08054879e-02,
  				-6.14042580e-02,
  				-5.06754369e-02,
  				 1.25910742e-02,
  				-5.26039489e-02,
  				-8.29643607e-02,
  				-5.73364682e-02,
  				-1.75813716e-02,
  				-7.00109378e-02,
  				 6.42818660e-02,
  				-1.05829854e-02,
  				 4.59340550e-02,
  				 6.24416582e-02,
  				-7.95485377e-02,
  				-1.24846287e-02,
  				-3.64224538e-02,
  				-7.01297000e-02,
  				-3.04255392e-02,
  				 6.48201406e-02,
  				-5.06679676e-02,
  				 8.20884332e-02,
  				 4.76366375e-03,
  				-1.13114724e-02,
  				 2.06946097e-02,
  				-1.83472526e-04,
  				-6.96688099e-03,
  				 3.29719298e-02,
  				 1.46114556e-02,
  				-3.79157029e-02,
  				 5.58227450e-02,
  				 5.32350168e-02,
  				 8.83519799e-02,
  				 5.01706675e-02,
  				 1.05289603e-02,
  				-1.33064212e-02,
  				 5.91109283e-02,
  				-3.10329720e-02,
  				-5.22528589e-02,
  				 7.37071261e-02,
  				 2.31154710e-02,
  				 1.10582657e-01,
  				 1.23600671e-02,
  				 1.80012565e-02,
  				 8.76817331e-02,
  				 5.88992983e-02,
  				-3.13987397e-02,
  				 6.82490319e-02,
  				 2.32157409e-02,
  				-5.31826727e-02,
  				 5.51359951e-02,
  				-6.00247495e-02,
  				 7.66183585e-02,
  				 5.10301217e-02,
  				 8.88520405e-02,
  				 2.37905309e-02,
  				-8.27847142e-03,
  				-4.37708348e-02,
  				 8.75923112e-02,
  				 3.96222770e-02,
  				-7.12859258e-02,
  				-2.60824673e-02,
  				 4.10529189e-02,
  				-5.95311709e-02,
  				 8.12211484e-02,
  				 9.67276767e-02,
  				 1.04147382e-01,
  				-4.14795168e-02
  		},

  		{
  				-7.93812796e-02,
  				 2.03339923e-02,
  				-8.90726224e-02,
  				-1.81224607e-02,
  				 6.23956472e-02,
  				-7.89087042e-02,
  				 7.18875900e-02,
  				 4.89854515e-02,
  				 1.57094672e-02,
  				-8.08027983e-02,
  				-3.46762836e-02,
  				 6.20376766e-02,
  				 1.63739230e-02,
  				-4.74243835e-02,
  				-7.52325207e-02,
  				-6.68464927e-03,
  				 2.94165704e-02,
  				-4.77432944e-02,
  				-2.69531216e-02,
  				 7.08469972e-02,
  				-5.58028333e-02,
  				-3.36545333e-02,
  				-2.72977538e-02,
  				 7.70138651e-02,
  				 3.05711874e-04,
  				 3.60555090e-02,
  				 3.31384428e-02,
  				 2.17053089e-02,
  				 2.75547355e-02,
  				 2.91697700e-02,
  				 7.07676485e-02,
  				-1.95192825e-02,
  				-7.35600740e-02,
  				 7.39524961e-02,
  				 7.10276887e-02,
  				-1.99441984e-02,
  				-1.24560925e-03,
  				 7.45844170e-02,
  				-4.01656842e-03,
  				 4.13221121e-02,
  				 3.04059554e-02,
  				 5.60676455e-02,
  				 4.42137867e-02,
  				-4.07762043e-02,
  				 3.09830364e-02,
  				 6.90608621e-02,
  				 8.16611201e-02,
  				-4.30713929e-02,
  				-2.37565879e-02,
  				 2.35302616e-02,
  				 8.12948942e-02,
  				 1.87844615e-02,
  				-6.67150542e-02,
  				 3.17413290e-03,
  				-9.21280356e-04,
  				 8.38811323e-02,
  				-5.50612919e-02,
  				-1.23211946e-02,
  				 7.79314563e-02,
  				 8.18520561e-02,
  				-9.86168627e-03,
  				-2.08915807e-02,
  				 5.95660461e-03,
  				-6.01470610e-03,
  				-5.33031560e-02,
  				-9.00010839e-02,
  				-1.59339216e-02,
  				 8.81605819e-02,
  				 5.27258441e-02,
  				-5.23577854e-02,
  				-4.20545377e-02,
  				-6.11030310e-02,
  				 9.74374190e-02,
  				 2.76360270e-02,
  				-1.89025179e-02,
  				 1.09746329e-01,
  				-9.34230313e-02,
  				-1.10230148e-01,
  				 1.02441479e-02,
  				 7.57780299e-02,
  				-8.98796692e-03,
  				 7.63830394e-02,
  				 5.59124872e-02,
  				-1.54152531e-02,
  				 2.63888370e-02,
  				-1.38527947e-02,
  				 1.63107384e-02,
  				-2.28716079e-02,
  				-8.86735395e-02,
  				 4.25535142e-02,
  				 7.68332854e-02,
  				-6.56376854e-02,
  				-6.49421066e-02,
  				-7.23745748e-02,
  				-5.82861416e-02,
  				 7.84002915e-02,
  				 4.81450222e-02,
  				-3.84829417e-02,
  				 9.47475433e-02,
  				 1.50379241e-02,
  				 1.97916701e-02,
  				-8.18188954e-03,
  				 4.87023257e-02,
  				 6.30078018e-02,
  				 7.02523962e-02,
  				-5.73025607e-02,
  				 3.62422951e-02,
  				 8.84880722e-02,
  				-3.08054183e-02,
  				 2.29886882e-02,
  				-1.19822305e-02,
  				-3.52154523e-02,
  				-2.01738477e-02,
  				-9.08948109e-03,
  				-4.58068922e-02,
  				 3.65662016e-02,
  				 1.41750006e-02,
  				-2.27804985e-02,
  				 4.62656282e-02,
  				 9.46643129e-02,
  				-3.73523775e-03,
  				-1.33026177e-02,
  				-3.25267240e-02,
  				 1.21494709e-02,
  				-1.02555947e-02,
  				 4.78936024e-02,
  				-4.35023792e-02,
  				 6.76947162e-02,
  				 6.12876229e-02,
  				-3.72615159e-02,
  				 6.28301920e-03,
  				 7.27814808e-02,
  				-5.46807535e-02,
  				-1.49759604e-02,
  				 2.24727392e-02,
  				 2.87841540e-02,
  				 7.52312243e-02,
  				 7.57816061e-02,
  				-6.99843168e-02,
  				-3.19178104e-02,
  				-3.88259534e-03,
  				 1.15418918e-02,
  				-3.81592624e-02,
  				 4.72948253e-02,
  				-2.95162406e-02,
  				-4.71830182e-02,
  				-5.19820713e-02,
  				 4.97508757e-02,
  				-7.87788033e-02,
  				-1.06117269e-02,
  				-1.62170250e-02,
  				-3.26261483e-02,
  				 5.14032952e-02,
  				-1.64653249e-02,
  				-4.90338961e-03,
  				-3.27853300e-02,
  				 8.07948932e-02,
  				 3.51425186e-02,
  				-4.04164866e-02,
  				-9.35489908e-02,
  				-8.17532092e-02,
  				 3.16228010e-02,
  				 2.14452352e-02,
  				-7.24995434e-02,
  				-8.15387145e-02,
  				 7.11541027e-02,
  				-5.37692122e-02,
  				 8.62298310e-02,
  				-2.88182609e-02,
  				-5.62872849e-02,
  				 1.39439385e-02,
  				 4.15304750e-02,
  				 8.19081534e-03,
  				-6.10152967e-02,
  				 1.87284611e-02,
  				 5.63181415e-02,
  				-2.50550769e-02,
  				-8.59449133e-02,
  				-6.04390390e-02,
  				-1.56217284e-04,
  				-1.15387462e-01,
  				-4.03101556e-02,
  				 5.52782752e-02,
  				 7.42386207e-02,
  				-2.00682003e-02,
  				 3.97215448e-02,
  				-8.51175487e-02,
  				 5.43853678e-02,
  				 1.48870954e-02,
  				 6.66567236e-02,
  				 1.68273225e-02,
  				-4.62835692e-02,
  				-6.64157271e-02,
  				-1.45260189e-02,
  				-3.49935852e-02,
  				 3.07017956e-02,
  				 8.38252753e-02,
  				-3.64913754e-02,
  				 4.36708331e-02,
  				 3.84301953e-02,
  				-3.72655727e-02,
  				-3.13215964e-02,
  				 7.67945647e-02,
  				-8.34258720e-02,
  				-6.88638762e-02,
  				 9.56624222e-04,
  				-2.96343118e-02,
  				-5.06747961e-02,
  				 1.15138926e-02,
  				-1.79229528e-02,
  				-5.99657074e-02,
  				 7.97750354e-02,
  				 1.00062869e-01,
  				-3.51640247e-02,
  				 5.59823513e-02,
  				-6.12894744e-02,
  				 7.46180415e-02,
  				 1.69413164e-02,
  				-1.80858392e-02,
  				 6.92974851e-02,
  				 8.53893347e-03,
  				-8.40257257e-02,
  				 2.71143541e-02,
  				-5.87186310e-03,
  				-6.44263700e-02,
  				 7.29199052e-02,
  				 2.27466021e-02,
  				 5.59568629e-02,
  				-5.73332086e-02,
  				 7.97376502e-03,
  				 8.14640895e-02,
  				-1.97247528e-02,
  				 4.38730903e-02,
  				-1.14814945e-01,
  				-7.40079805e-02,
  				 4.12513465e-02,
  				 3.48853320e-02,
  				 5.29668666e-02,
  				 6.61609098e-02,
  				-3.98033075e-02,
  				-3.56543958e-02,
  				 5.39490692e-02,
  				 9.42702964e-02,
  				-3.85676101e-02,
  				-3.74336056e-02,
  				 1.89476032e-02,
  				-5.78482673e-02,
  				 5.75035885e-02,
  				 3.39175249e-03,
  				 4.41399440e-02,
  				-3.91318602e-03,
  				-7.34424815e-02,
  				 2.52012219e-02,
  				 5.96152134e-02,
  				-2.12270155e-04,
  				-4.48643640e-02,
  				 1.73383337e-02,
  				-6.84241131e-02,
  				 4.64414433e-03,
  				 7.38030579e-03,
  				 7.86287487e-02,
  				-2.24670544e-02,
  				-1.73164047e-02,
  				-1.98324109e-04,
  				-4.26370576e-02,
  				-2.27795839e-02,
  				 2.13825274e-02,
  				 7.35930130e-02,
  				-4.14679945e-02,
  				 2.83671226e-02,
  				-1.15286238e-01,
  				-4.31468077e-02,
  				 1.81191377e-02,
  				 2.87435278e-02,
  				-4.37624939e-02,
  				-9.95336547e-02,
  				-7.95424059e-02,
  				-2.51937527e-02,
  				-3.10919732e-02,
  				-1.86225288e-02,
  				-2.02987175e-02,
  				-6.87292442e-02,
  				 3.13891447e-03,
  				 5.51733188e-02,
  				-4.05363962e-02,
  				-5.72518930e-02,
  				-8.98521766e-02,
  				 1.15066683e-02,
  				-1.83233842e-02,
  				 1.30300913e-02,
  				-1.42626939e-02,
  				-5.03955297e-02,
  				-7.37863109e-02,
  				-1.65718477e-02,
  				 2.46760398e-02,
  				 1.40389260e-02,
  				 4.16480564e-02,
  				 4.49194685e-02,
  				-2.72136200e-02,
  				 4.71190400e-02,
  				-6.10904098e-02,
  				-8.24328139e-02,
  				-8.31845403e-03,
  				-6.40450940e-02,
  				-2.19367514e-03,
  				 3.64002399e-02,
  				 2.74918135e-03,
  				 5.09380363e-02,
  				 4.19291556e-02,
  				-4.85482775e-02,
  				 4.82945889e-02,
  				-3.96978250e-03,
  				-6.21058270e-02,
  				-3.78347039e-02,
  				-8.27121809e-02,
  				 2.20682733e-02,
  				 3.94809395e-02,
  				 6.20611385e-02,
  				 6.63420334e-02,
  				 3.03767826e-02,
  				-7.71005750e-02,
  				-2.57847551e-02,
  				 3.55362184e-02,
  				 4.70965393e-02,
  				 5.86385578e-02,
  				-6.29979894e-02,
  				-5.09256497e-02,
  				 7.80795440e-02,
  				 6.57409206e-02,
  				 4.50683571e-02,
  				-7.31885582e-02,
  				 2.05394085e-02,
  				-3.58468965e-02,
  				 8.12591538e-02,
  				 9.79365483e-02,
  				 7.10894354e-03,
  				-6.68918714e-02,
  				-5.81688471e-02,
  				 6.59700036e-02,
  				 7.63931498e-02,
  				-2.16526370e-02,
  				-6.87070861e-02,
  				 5.01901917e-02,
  				-1.90880727e-02,
  				-2.92339884e-02,
  				 6.40505329e-02,
  				 5.03244437e-02,
  				 2.11330187e-02,
  				-3.40642072e-02,
  				-1.00420751e-01,
  				-2.62690242e-02,
  				 1.06136734e-02,
  				-9.63273365e-03,
  				 2.72007585e-02,
  				-6.66983202e-02,
  				-9.35072452e-03,
  				-5.18677346e-02,
  				 3.90865281e-02,
  				 5.36477380e-02,
  				-1.39172412e-02,
  				-5.13838045e-02,
  				 8.48670974e-02,
  				-1.99589953e-02,
  				 4.89505157e-02,
  				 1.90876070e-02,
  				 6.01355471e-02,
  				 4.68421690e-02,
  				-6.58909306e-02,
  				-4.28288803e-02,
  				 1.40828686e-03,
  				-3.68433706e-02,
  				-2.30943859e-02,
  				-4.11405601e-02,
  				 9.36287716e-02,
  				 5.49080968e-03,
  				 7.03482330e-02,
  				 4.30303924e-02,
  				 4.41888422e-02,
  				 2.37479005e-02,
  				-8.19599703e-02,
  				 3.37546542e-02,
  				 8.36116746e-02,
  				-2.07253415e-02,
  				 6.66943714e-02,
  				-2.29830053e-02,
  				 9.59826261e-03,
  				 2.83894036e-02,
  				-2.54137591e-02,
  				 5.62197417e-02,
  				-6.05282970e-02,
  				-3.80736440e-02,
  				-4.97615151e-02,
  				-3.11035737e-02,
  				 5.45930751e-02,
  				-2.28217114e-02,
  				 2.37992965e-02,
  				-2.43424438e-02,
  				-2.55640838e-02,
  				 8.85512307e-03,
  				 2.56801080e-02,
  				-5.99862188e-02,
  				 7.04586282e-02,
  				-4.96599823e-03,
  				-5.29949702e-02,
  				 7.59021565e-02,
  				 8.29197690e-02,
  				 3.21314074e-02,
  				-6.60800040e-02,
  				 3.92077342e-02,
  				 4.32409011e-02,
  				 4.48899865e-02,
  				 3.17118578e-02,
  				-4.67601083e-02,
  				-7.41093159e-02,
  				-9.81691759e-04,
  				-2.76380908e-02,
  				 6.50357157e-02,
  				-7.94976503e-02,
  				-6.22556265e-03,
  				-5.30784065e-03,
  				-4.40252088e-02,
  				 2.75512245e-02,
  				 1.93129480e-02,
  				 6.19566478e-02,
  				 3.00576612e-02,
  				-5.99641614e-02,
  				-6.87731104e-03,
  				-1.89661663e-02,
  				-5.93277179e-02,
  				 6.17631003e-02,
  				 2.72400081e-02,
  				 5.35061993e-02,
  				-7.09672868e-02,
  				 5.83183281e-02,
  				-9.93028283e-02,
  				-7.66625535e-03,
  				 3.88031267e-03,
  				-8.15083534e-02,
  				 1.86490733e-02,
  				 3.82432435e-03,
  				-9.09247547e-02,
  				 4.09245752e-02,
  				-6.78549409e-02,
  				 3.37489769e-02,
  				-9.65420604e-02,
  				 3.76762524e-02,
  				-4.97108288e-02,
  				-9.01153013e-02,
  				-2.55428068e-02,
  				-6.73410594e-02,
  				 7.83300325e-02,
  				-1.02176871e-02,
  				-4.26857024e-02,
  				 5.80418063e-03,
  				-7.91212618e-02,
  				-2.63300762e-02,
  				-4.91983667e-02,
  				 1.48574226e-02,
  				-7.76012167e-02,
  				-5.56030832e-02,
  				-4.88749519e-02,
  				 5.94806708e-02,
  				 1.44420448e-03,
  				 2.63067968e-02,
  				 2.99525596e-02,
  				-1.49169480e-02,
  				-6.25903904e-03,
  				 7.51387421e-03,
  				 3.66325602e-02,
  				-1.87491626e-02,
  				 5.11309467e-02,
  				 6.56672791e-02,
  				-1.04947072e-02,
  				 9.42196772e-02,
  				 1.87780783e-02,
  				 7.88482651e-02,
  				-7.94249400e-02,
  				 1.49828633e-02,
  				-4.03757729e-02,
  				-3.90157588e-02,
  				-6.87955096e-02,
  				-3.20186764e-02,
  				 4.09951843e-02,
  				-5.49109690e-02,
  				 5.39932884e-02,
  				-6.60585687e-02,
  				 5.06861284e-02,
  				 2.56228782e-02,
  				-2.89259646e-02,
  				-6.14678264e-02,
  				 3.62594798e-02,
  				-4.33306843e-02,
  				 5.27557172e-02,
  				-6.40027672e-02,
  				-1.65903922e-02,
  				 2.25993562e-02,
  				 9.25760120e-02,
  				-4.25749235e-02,
  				-1.98674817e-02,
  				 2.83306409e-02,
  				-2.39520445e-02,
  				 3.50949280e-02,
  				 4.83245291e-02,
  				 5.72197773e-02,
  				 7.92620182e-02,
  				 1.12962071e-02,
  				 1.16695091e-02,
  				-3.46296094e-02,
  				-5.16593792e-02,
  				 1.63641907e-02,
  				-3.23633030e-02,
  				-5.26037253e-02,
  				 2.51545515e-02,
  				 6.10565767e-02,
  				 8.05074647e-02,
  				-5.38259633e-02,
  				 9.12098885e-02,
  				 4.69619334e-02,
  				-1.06583368e-02,
  				-3.24220769e-02,
  				-2.57975832e-02,
  				-1.05189957e-01,
  				-9.78353526e-03,
  				 4.68042828e-02,
  				 5.64327575e-02,
  				 5.32592982e-02,
  				 3.95546341e-03,
  				 1.19578168e-02,
  				 9.06128362e-02,
  				 1.58203747e-02,
  				 8.37416127e-02,
  				-5.19131422e-02,
  				-1.81521778e-03,
  				-6.04622178e-02,
  				 4.14083339e-02,
  				 6.03147186e-02,
  				 2.62873881e-02,
  				-2.32623760e-02,
  				 6.31267801e-02,
  				-5.48803098e-02,
  				 8.58085975e-02,
  				-4.10095900e-02,
  				 7.43971318e-02,
  				-5.07831748e-04,
  				-6.42234236e-02,
  				-6.48804232e-02,
  				 3.82862464e-02,
  				-1.60744778e-04,
  				-4.73613553e-02,
  				 2.80500017e-02,
  				-6.73293546e-02,
  				 8.43082089e-03,
  				-3.12600844e-02,
  				-7.90761560e-02,
  				 1.77704953e-02,
  				 3.95149877e-03,
  				-2.86119618e-02,
  				 8.01268518e-02,
  				-6.40553534e-02,
  				-3.49196717e-02,
  				-4.16384079e-02,
  				-3.48744690e-02,
  				-6.32426236e-03,
  				-7.25159794e-02,
  				 3.75088975e-02,
  				 1.64437853e-02,
  				-5.43235503e-02,
  				 4.69731726e-02,
  				 8.49763900e-02,
  				-4.70448248e-02,
  				-5.84930889e-02,
  				-1.31930290e-02,
  				-5.97164556e-02,
  				 5.02137393e-02,
  				-3.51141095e-02,
  				 1.48229171e-02,
  				-1.99482907e-02,
  				 5.90712652e-02,
  				-2.02409234e-02,
  				-7.19783679e-02,
  				 6.12965412e-02,
  				 1.40042361e-02,
  				 5.99831641e-02,
  				 3.10092443e-03,
  				-6.25249892e-02,
  				 4.94465139e-03,
  				-6.64548129e-02,
  				-4.90432195e-02,
  				-8.17663819e-02,
  				-7.65029639e-02,
  				 6.11873567e-02,
  				 1.50156207e-02,
  				-5.39107621e-03,
  				-4.27921712e-02,
  				-2.63494775e-02,
  				 1.44663388e-02,
  				 6.42165393e-02,
  				 7.17071891e-02,
  				 7.17168227e-02,
  				-8.73344764e-02,
  				 2.85491459e-02,
  				-3.18699740e-02,
  				-6.43797591e-02,
  				-4.04779892e-03,
  				 8.15656036e-02,
  				-2.30337307e-02,
  				 6.24957494e-02,
  				-7.22243786e-02,
  				-2.24917792e-02,
  				-1.15585178e-02,
  				-4.77095600e-03,
  				 1.04087042e-02,
  				-1.00923534e-02,
  				 2.01106928e-02,
  				-7.07508475e-02,
  				-7.42680207e-03,
  				-7.69289164e-03,
  				-8.99337756e-05,
  				-1.19512174e-02,
  				-5.43377921e-02,
  				 5.04369549e-02,
  				 5.12994733e-03,
  				 5.88274710e-02,
  				 3.09604816e-02,
  				-4.17225175e-02,
  				-6.33784905e-02,
  				 1.90325640e-02,
  				-6.48766756e-02,
  				 2.28078868e-02,
  				-6.71370402e-02,
  				-7.84879550e-02,
  				-9.40072350e-03,
  				-9.65538807e-03,
  				-8.13791901e-02,
  				 4.24914854e-03,
  				 3.77175361e-02,
  				 7.40134865e-02,
  				-5.66889830e-02,
  				 6.49601817e-02,
  				 9.72670764e-02,
  				-6.22500256e-02,
  				-4.40242514e-02,
  				-7.46835172e-02,
  				 9.90924798e-03,
  				-4.89767753e-02,
  				 7.00980425e-02,
  				 4.67875265e-02,
  				 9.71273556e-02,
  				 5.71128204e-02,
  				 3.70499678e-02,
  				-5.46860993e-02,
  				-2.23946106e-03,
  				 2.86229085e-02,
  				 2.37263907e-02,
  				-2.27946602e-02,
  				-4.24961559e-02,
  				 4.96825315e-02,
  				 8.41870531e-03,
  				-4.50667180e-03,
  				 4.47862856e-02,
  				-3.32175754e-02,
  				 8.57770890e-02,
  				 1.02715954e-01,
  				-2.04401594e-02,
  				 7.38217458e-02,
  				 5.73284812e-02,
  				 5.23791760e-02,
  				-2.74662469e-02,
  				-1.90504175e-02,
  				-4.69600298e-02,
  				-8.26299284e-03,
  				 2.42224820e-02,
  				-5.94260804e-02,
  				 7.14407042e-02,
  				-6.22881800e-02,
  				-6.65333420e-02,
  				-3.07399165e-02,
  				 1.72764398e-02,
  				-5.17093726e-02,
  				-3.65795605e-02,
  				 1.55684799e-02,
  				 3.06070540e-02,
  				 1.04539707e-01,
  				 2.47639399e-02,
  				 1.58958938e-02,
  				-5.68049550e-02,
  				-5.55666871e-02,
  				 5.74069619e-02,
  				 6.32614419e-02,
  				-7.63250887e-02,
  				 6.87187444e-03,
  				-4.34867255e-02,
  				 1.68245647e-03,
  				 2.63378173e-02,
  				 1.10288914e-02,
  				 1.99605729e-02,
  				 1.85952373e-02,
  				-9.81820002e-02,
  				 4.15797681e-02,
  				-7.36693740e-02,
  				-1.44216120e-02,
  				 4.43194509e-02,
  				-3.17918584e-02,
  				-2.49831788e-02,
  				 1.78752411e-02,
  				 6.33825138e-02,
  				-4.54903245e-02,
  				-4.77946922e-02,
  				 1.94952767e-02,
  				 1.81614049e-02,
  				-5.27429655e-02,
  				-4.99009229e-02,
  				 1.63799264e-02,
  				-5.52193820e-02,
  				 2.92971376e-02,
  				-5.45638464e-02,
  				 1.81263648e-02,
  				-4.66771275e-02,
  				 6.41099066e-02,
  				 2.78950743e-02,
  				-4.94251661e-02,
  				-2.45696940e-02,
  				 2.33712643e-02,
  				-4.29369695e-02,
  				 7.27447122e-02,
  				-3.98747660e-02,
  				-1.26595786e-02,
  				-4.66055423e-02,
  				-9.28230807e-02,
  				-6.84818476e-02,
  				 2.17642561e-02,
  				 6.24735579e-02,
  				 4.51676138e-02,
  				-4.86576632e-02,
  				 4.96991128e-02,
  				 4.87938430e-03,
  				-2.76444349e-02,
  				 7.51303509e-02,
  				 1.42499311e-02,
  				-3.83659005e-02,
  				 6.35484010e-02,
  				 5.90353012e-02,
  				-6.62199259e-02,
  				 2.20329594e-02,
  				 3.97682674e-02,
  				 6.44176379e-02,
  				 2.21634144e-03,
  				 9.10043344e-02,
  				-7.60444254e-03,
  				-1.92683768e-02,
  				-3.74262780e-02,
  				 3.01114433e-02,
  				 4.77033183e-02,
  				-1.27400104e-02,
  				 1.94713268e-02,
  				-5.29219806e-02,
  				-5.78129105e-02,
  				 2.57853027e-02,
  				-2.11622864e-02,
  				 4.94618602e-02,
  				-2.27930443e-03,
  				-2.31765173e-02,
  				-8.87772813e-02,
  				 6.60632625e-02,
  				 8.02737698e-02,
  				-6.13326579e-03,
  				 5.59531040e-02,
  				 1.94788612e-02,
  				-7.47764558e-02,
  				 3.83766964e-02,
  				-1.81207433e-02,
  				-2.61442438e-02,
  				-2.34154053e-03,
  				-6.00083848e-04,
  				 5.25823273e-02,
  				 7.56220287e-03,
  				-6.64098794e-03,
  				 6.75301775e-02,
  				 2.50323024e-03,
  				 8.29414278e-02,
  				-3.49243954e-02,
  				 2.39299573e-02,
  				 7.50449374e-02,
  				 4.91905734e-02,
  				-7.67106488e-02,
  				 1.60176959e-02,
  				-6.46793991e-02,
  				-2.13378798e-02,
  				 4.72716764e-02,
  				-2.37939786e-02,
  				-2.59869639e-02,
  				 1.00917615e-01,
  				 6.20868728e-02,
  				-3.58320288e-02,
  				-4.11099978e-02,
  				 5.10923788e-02,
  				 1.88830364e-02,
  				-4.87343445e-02,
  				 1.18397465e-02,
  				-2.91096680e-02,
  				-7.41201863e-02,
  				-5.95813841e-02,
  				-5.28994575e-02,
  				-6.90829102e-03,
  				-2.41104346e-02,
  				-4.16931920e-02,
  				-4.94531803e-02,
  				-2.19927542e-02,
  				 4.39816564e-02,
  				 3.53900976e-02,
  				 2.93818936e-02,
  				 2.32448373e-02,
  				 4.85021994e-02,
  				 1.80540737e-02,
  				-1.46618476e-02,
  				-7.89312497e-02,
  				 6.35289177e-02,
  				 2.00693719e-02,
  				-1.32787433e-02,
  				 2.42597740e-02,
  				 1.80671513e-02,
  				-7.27582537e-03,
  				 2.37754546e-02,
  				-2.71756817e-02,
  				-7.61894584e-02,
  				-3.86774503e-02,
  				 2.73410627e-03,
  				-6.52630702e-02,
  				 1.56850405e-02,
  				-1.93033349e-02,
  				 1.42551428e-02,
  				-2.13682763e-02,
  				-1.42571311e-02,
  				 3.33515182e-02,
  				 3.34726251e-03,
  				-4.37280610e-02,
  				 1.24387955e-02,
  				-3.79742011e-02,
  				-7.02826604e-02,
  				-2.84151193e-02,
  				 3.30730006e-02,
  				 3.32126431e-02,
  				-1.81132294e-02,
  				 6.25150129e-02,
  				 2.34429333e-02,
  				 8.70843828e-02,
  				 3.35659832e-02,
  				-4.42661718e-02,
  				 6.07515164e-02,
  				-1.13669761e-01,
  				-2.85214223e-02,
  				 5.97001519e-03,
  				 4.60952744e-02,
  				-7.83770904e-02,
  				-5.19591942e-02,
  				-2.61919387e-02,
  				 8.27481896e-02,
  				-6.15022741e-02,
  				 6.50110319e-02,
  				-7.33953193e-02,
  				-6.69787899e-02,
  				-4.83159609e-02,
  				 3.12101468e-02,
  				 1.07894195e-02
  		}
  };


  int error_count = 0;

  int i, j, k, l, x, y;
  unsigned char t;
  start = std::clock();
  for(int loop = 0; loop < 20; loop++) {
	  for(i = 0; i < N; i++) {
		  for(j = 0; j < N; j++) {
			  //in_mat_a9[i][j]=((mat_a)rand())/RAND_MAX;
			  image0.read((char *)(&t), 1);
			  in_mat_a[i][j]= t;
//			  cout << in_mat_a[i][j] << " " ;
		  }
//		  cout << "\n";
	  }


  	  obj_detector_sw(in_mat_a, in_mat_w0, in_mat_w1, sw_result);
  	  for(int k = 0; k < NUM_CLASSES; k++) {
  		  cout << sw_result[k] << " ";
  	  }
  	cout << "  |\n";
  }

  for(int loop = 0; loop < 20; loop++) {
	  for(i = 0; i < N; i++) {
		  for(j = 0; j < N; j++) {
			  //in_mat_a9[i][j]=((mat_a)rand())/RAND_MAX;
			  image1.read((char *)(&t), 1);
			  in_mat_a[i][j]= t;
//			  cout << in_mat_a[i][j] << " " ;
		  }
		  //cout << "\n";
	  }


  	  obj_detector_sw(in_mat_a, in_mat_w0, in_mat_w1, sw_result);
  	  for(int k = 0; k < NUM_CLASSES; k++) {
 		  cout << sw_result[k] << " ";
  	  }
  	cout << "  |\n";
  }

  end = std::clock();

  std::cout << "time = " << (end - start) / (double)(CLOCKS_PER_SEC) /10000 << std::endl;

  cout << sw_result[0] << "\t" << sw_result[1];

#ifdef HW_COSIM
    // Run the Vivado HLS matrix multiplier
    obj_detector(in_mat_a, in_mat_w0, in_mat_w1, hw_result);
    cout << hw_result[0] << "\t" << hw_result[1];
#endif

    // Print product matrix
    for (int i = 0; i < NUM_CLASSES; i++) {
    	//for (int j = 0; j < (N-M+1)/2; j++) {
    		//for (int k = 0; k < (N-M+1)/2; k++) {
#ifdef HW_COSIM
	// Check result of HLS vs. expected
	if (!nearlyEqual(hw_result[i], sw_result[i])) {
	  error_count++;

	  //cout << i << " , " << j << " , " << k << " -- ";
	  //cout << sw_result[i] << " vs. " << hw_result[i] << "\n";
		}
    //}
   //}

// #else

#endif
      //}
    }

#ifdef HW_COSIM
  if (error_count)
    cout << "TEST FAIL: " << error_count << " Results do not match!" << endl;
  else
    cout << "Test passed!" << endl;
#endif
  return error_count;
}

void obj_detector_sw(float A[N][N], float W0[NUM_NEURONS][M][M], float W1[NUM_CLASSES][NUM_NEURONS*((N-M+1)/2)*((N-M+1)/2)], float res[NUM_CLASSES]) {

	float s0[NUM_NEURONS][N-M+1][N-M+1];
	float s1[NUM_NEURONS][N-M+1][N-M+1];
	float s2[NUM_NEURONS][(N-M+1)/2][(N-M+1)/2];
	float s3[NUM_NEURONS*((N-M+1)/2)*((N-M+1)/2)];
	float cost[NUM_CLASSES];

	// Layer 1 - convolution
	for(int i=0; i<NUM_NEURONS; i++) {
		convolve_sw(A, W0[i], s0[i]);
	}

	// Layer 2 - ReLU
	for (int i=0; i<NUM_NEURONS; i++) {
		ReLU_sw(s0[i], s1[i]);
	}

	// Layer 3 - Maxpool
	for (int i=0; i<NUM_NEURONS; i++) {
		maxpool_sw(s1[i], s2[i]);
	}

	// Layer 4 - Flatten
	flatten_sw(s2, s3);

	// Layer 5 - FCL
	cost[0] = FCL_sw(s3, W1[0]);
	cost[1] = FCL_sw(s3, W1[1]);

	// Layer 6 - Softmax
	softmax_sw(cost, res);

}


void convolve_sw (float A[N][N], float B[M][M], float conv[N-M+1][N-M+1]) {
  int x,  y;
  int i,j,k,l;

  for (i=M/2; i<N-(M/2); i++) {
    for (j=M/2; j<N-(M/2); j++) {
    	conv[i-M/2][j-M/2] = 0;
      for (k=0; k<M; k++) {
        for (l=0; l<M; l++) {
          x = i-M/2 + k;
          y = j-M/2 + l;
          // printf("%d %d\n", A[x][y], B[k][l]);
          conv[i-M/2][j-M/2] += A[x][y] * B[k][l];
          //cout << conv[i-M/2][j-M/2] << " = " << A[x][y] << " * " << B[k][l] << "\n";
        }
      }
    }
  }
}

void ReLU_sw(float inp[N-M+1][N-M+1], float out[N-M+1][N-M+1]) {
	for (int i=0; i<N-M+1; i++) {
		for (int j=0; j<N-M+1; j++) {
			//out[i][j] = fmax(0, inp[i][j]);
			if (inp[i][j] > 0) {
				out[i][j] = inp[i][j];
			}
			else {
				out[i][j] = 0;
			}
			//cout << inp[i][j] << " vs. " << out[i][j] << "\n";
		}
	}
}

void maxpool_sw(float inp[N-M+1][N-M+1], float out[(N-M+1)/2][(N-M+1)/2]) {
	float max;
	for (int i=0; i<(N-M+1)/2; i++) {
		for (int j=0; j<(N-M+1)/2; j++) {
			if (inp[2*i][2*j] > inp[2*i][(2*j)+1]) {
				max = inp[2*i][2*j];
			} else {
				max = inp[2*i][(2*j)+1];
			}
			if (inp[(2*i)+1][2*j] > max) {
				max = inp[(2*i)+1][2*j];
			}
			if (inp[(2*i)+1][(2*j)+1] > max) {
				max = inp[(2*i)+1][(2*j)+1];
			}
			out[i][j] = max;
			//cout << max << " -- " << inp[(2*i)][(2*j)] << " " << inp[(2*i)+1][(2*j)+1] << " " << inp[(2*i)+1][2*j] << " " << inp[(2*i)+1][(2*j)+1] << "\n";
			/*
			max = 0;
			for (int k=2*i; k<2*i+1; k++) {
				for (int l=2*j; l<2*j+1; l++) {
					if (inp[k][l] > max) {
						max = inp[k][l];
					}
				}
			}
			*/
		}
	}
}

void flatten_sw(float inp[NUM_NEURONS][(N-M+1)/2][(N-M+1)/2], float out[NUM_NEURONS*((N-M+1)/2)*((N-M+1)/2)]) {
	for (int i=0; i<NUM_NEURONS; i++) {
		for (int j=0; j<((N-M+1)/2); j++){
			for (int k=0; k<((N-M+1)/2); k++) {
				out[(i*((N-M+1)/2)*((N-M+1)/2)) + ((((N-M+1)/2))*j) + k] = inp[i][j][k];
			}
		}
	}
}

float FCL_sw(float inp[NUM_NEURONS*((N-M+1)/2)*((N-M+1)/2)], float W[NUM_NEURONS*((N-M+1)/2)*((N-M+1)/2)]) {
	float out = 0;
	for (int i=0; i<(NUM_NEURONS*((N-M+1)/2)*((N-M+1)/2)); i++) {
		out += inp[i]*W[i];
		//cout << out << " = " << inp[i] << " * " << W[i] << "\n";
	}
	return out;
}

void softmax_sw(float inp[NUM_CLASSES], float out[NUM_CLASSES]) {
	float sum = 0;
	float temp[NUM_CLASSES];
	for (int i=0; i<NUM_CLASSES; i++) {
		sum += inp[i];
	}
	for (int i=0; i<NUM_CLASSES; i++) {
		temp[i] = inp[i]/sum;
	}
	sum = 0;
	for(int i=0; i<NUM_CLASSES; i++) {
		sum += exp(temp[i]);
	}
	for (int i=0; i<NUM_CLASSES; i++) {
		out[i] = exp(temp[i])/sum;
	}
}
